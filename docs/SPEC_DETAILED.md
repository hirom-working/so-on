# So-On 詳細仕様書

## 1. アプリ概要

### 1.1 コンセプト
レトロなカセットテープデッキを模したミニマルデザインの環境音再生アプリ。睡眠導入や日常のリラックス用途に特化し、シンプルで直感的な操作性を提供する。

### 1.2 アプリ名
未定（仮称: So-On）

### 1.3 ターゲットプラットフォーム
- **iOS**: 15.0以上
- **Android**: 12.0 (API Level 31) 以上
- **フレームワーク**: React Native
- **同時リリース**: iOS / Android 両プラットフォーム同時

---

## 2. デザイン仕様

### 2.1 ビジュアルスタイル
- **コンセプト**: ミニマル復古 - レトロ要素を抽象化したシンプルなデザイン
- **モチーフ**: カセットテープデッキ

### 2.2 カラーパレット
70年代風レトロカラー（参考: 8-Subduced-swirls.jpg）

| 用途 | カラーコード | 説明 |
|------|-------------|------|
| ベース/背景 | #F2D8B3 | クリームベージュ |
| アクセント1 | #FBD266 | マスタードイエロー |
| アクセント2 | #8FB0A9 | セージグリーン |
| アクセント3 | #D76735 | テラコッタオレンジ |

### 2.3 フォント
- **スタイル**: モダンミニマル（シンプルなサンセリフ体）
- **用途**: ラベル、時間表示、ボタンテキスト

### 2.4 画面レイアウト（縦固定）

```
┌─────────────────────────────┐
│                             │
│  ┌─────────┐  ┌─────────┐  │  ← VUメーター + 時間ダイヤル
│  │VUメーター│  │時間ダイヤル│  │
│  └─────────┘  └─────────┘  │
│                             │
│  ┌───────────────────────┐  │
│  │                       │  │
│  │    カセットテープ      │  │  ← カセットテープ（タップで音源選択）
│  │    ┌───────────────┐  │  │
│  │    │   音源名表示   │  │  │  ← ラベル部分
│  │    └───────────────┘  │  │
│  │   ◎ ─────────── ◎   │  │  ← 窓から見えるリール（残量表示）
│  │                       │  │
│  └───────────────────────┘  │
│                             │
│    [ ▶ ]  [ ■ ]  [ ⚙ ]    │  ← 再生・停止・設定ボタン
│                             │
└─────────────────────────────┘
```

---

## 3. UI要素詳細

### 3.1 カセットテープ
- **外観**: ミニマルに抽象化されたカセットテープ
- **窓部分**: 左右のリールが見え、残り時間に完全連動してテープ量が変化
- **ラベル**: 現在の音源名を表示
- **インタラクション**: タップで音源選択画面へ遷移（複数音源時）

### 3.2 テープリール（カセット窓内）
- **動作**: 再生中は回転、停止中は静止
- **テープ消費表現**: 経過時間に応じて送り側リールのテープが減少し、受け側に移動
- **完全連動**: 設定時間と残り時間に正確に対応

### 3.3 VUメーター
- **タイプ**: 針式アナログメーター風（モノラル単一）
- **動作**: 実際の再生音量にリアルタイム連動
- **配置**: カセットの上部

### 3.4 時間選択ダイヤル
- **スタイル**: レトロなロータリーダイヤル
- **操作**: 回転ジェスチャーで値を変更
- **選択肢**: 15分 / 30分 / 45分 / 60分 / 90分
- **配置**: カセットの上部（VUメーターの横）

### 3.5 コントロールボタン
- **配置**: カセットの下に横並び
- **種類**:
  - 再生ボタン（▶）
  - 停止ボタン（■）
  - 設定ボタン（⚙）
- **デザイン**: 物理ボタン風の押し込み可能なデザイン
- **フィードバック**:
  - 視覚: 押し込みアニメーション
  - 触覚: バイブレーション

### 3.6 音源選択画面（将来の複数音源対応時）
- **形式**: カード形式
- **表示**: アイコン付きカード
- **遷移**: カセットテープをタップで開く

---

## 4. 音声仕様

### 4.1 音源構造
```
[テープ走行音] → [起動音] → [中間ループ ×N] → [停止音] → [テープ停止音]
     ↓              ↓            ↓              ↓            ↓
   短い効果音    洗濯機起動    洗濯機稼働音    洗濯機停止    短い効果音
```

### 4.2 音源ファイル構成（1音源あたり）
| ファイル | 説明 | 備考 |
|---------|------|------|
| tape_start.* | テープ走行開始音 | 共通/個別 |
| intro.* | 機械起動音 | 音源固有 |
| loop.* | メインループ音源 | 5分〜30分程度 |
| outro.* | 機械停止音 | 音源固有 |
| tape_stop.* | テープ停止音 | 共通/個別 |

### 4.3 初期音源
- **種類**: 洗濯機の稼働音
- **提供方法**: ユーザー自身で用意
- **ファイル**:
  - 洗濯機起動音
  - 洗濯機稼働音（ループ用）
  - 洗濯機停止音
  - テープ走行音/停止音

### 4.4 音声フォーマット
- **推奨形式**: AAC（.m4a）
  - iOS/Android両対応
  - 高音質かつ効率的な圧縮
- **代替形式**: WAV（無圧縮）も可
- **サンプルレート**: 44.1kHz または 48kHz
- **ビットレート**: 256kbps以上推奨

### 4.5 ループ処理
- **方式**: クロスフェード
- **クロスフェード時間**: 5秒以上（長め）
- **実装**: 2つの音声トラックを重ねてスムーズに繋ぐ

### 4.6 音量
- **調整方法**: システム音量のみ使用（アプリ内調整なし）
- **全音源統一音量**: テープ走行音、起動/停止音、ループ音はすべて同じ音量

---

## 5. 機能仕様

### 5.1 再生機能
- **再生開始シーケンス**:
  1. テープ走行音再生
  2. 機械起動音再生
  3. ループ音源再生開始
  4. 設定時間まで繰り返し

- **再生停止シーケンス**:
  1. ループ音源フェードアウト開始
  2. 機械停止音再生
  3. テープ停止音再生

### 5.2 タイマー機能
- **プリセット時間**: 15分 / 30分 / 45分 / 60分 / 90分
- **デフォルト**: 30分
- **設定変更**: 再生中も変更可能
- **完了時**: 音が止まるのみ（通知なし）

### 5.3 設定の永続化
- **保存項目**:
  - 選択された再生時間
  - 選択された音源（将来）
- **初回起動**: デフォルト30分で即再生可能
- **2回目以降**: 前回の設定を復元

### 5.4 バックグラウンド動作
- **動作**: バックグラウンドで一時停止
- **復帰時**: フォアグラウンドに戻ると再開
- **実装**: アプリのライフサイクルイベントで制御

### 5.5 アプリ終了
- **動作**: 確認なしで即座に終了
- **再生中**: 終了と同時に再生も停止

---

## 6. 画面遷移

### 6.1 メイン画面
- アプリの唯一のメイン画面
- 全ての操作をこの画面で完結

### 6.2 音源選択画面（モーダル）
- カセットタップで表示
- カード形式で音源を一覧表示
- 音源タップで選択・画面閉じる

### 6.3 設定画面
- 設定ボタンタップで表示
- **内容**:
  - バージョン情報
  - ライセンス情報
  - （将来的にフィードバック機能等）

---

## 7. 拡張性

### 7.1 音源追加方式
- **方法**: アプリアップデートで追加
- **構造**: 新しい音源セットをアプリにバンドル

### 7.2 音源メタデータ
技術的に最適な方法で実装（JSON設定ファイル推奨）

```json
{
  "sounds": [
    {
      "id": "washing_machine",
      "name": {
        "ja": "洗濯機",
        "en": "Washing Machine"
      },
      "icon": "washing_machine.png",
      "files": {
        "tape_start": "common/tape_start.m4a",
        "intro": "washing_machine/intro.m4a",
        "loop": "washing_machine/loop.m4a",
        "outro": "washing_machine/outro.m4a",
        "tape_stop": "common/tape_stop.m4a"
      },
      "loopDuration": 300
    }
  ]
}
```

---

## 8. ローカライズ

### 8.1 対応言語
- 日本語（ja）
- 英語（en）

### 8.2 ローカライズ対象
- UIテキスト（ボタンラベル、設定項目等）
- 音源名
- 設定画面のテキスト
- App Store / Google Play ストア掲載文

---

## 9. 技術要件

### 9.1 開発環境
- **フレームワーク**: React Native
- **言語**: TypeScript
- **状態管理**: 適切なライブラリを選定（Redux/Zustand等）

### 9.2 音声処理
- **ライブラリ**: react-native-sound または expo-av
- **要件**:
  - 複数トラック同時再生（クロスフェード用）
  - バックグラウンド再生制御
  - 音量レベル取得（VUメーター用）

### 9.3 アニメーション
- **ライブラリ**: React Native Reanimated
- **対象**:
  - リール回転
  - テープ消費表現
  - VUメーター針の動き
  - ボタン押し込み
  - ダイヤル回転

### 9.4 永続化
- **ライブラリ**: AsyncStorage または MMKV
- **データ**: 設定値の保存・復元

### 9.5 触覚フィードバック
- **ライブラリ**: react-native-haptic-feedback
- **使用箇所**: ボタンタップ時

---

## 10. 品質要件

### 10.1 テスト
- **ユニットテスト**: コアロジック（タイマー、音声制御等）
- **統合テスト**: UI/コンポーネント統合テスト
- **動作確認**: シミュレーター + 実機

### 10.2 エラーハンドリング
- **充実した対応**:
  - 詳細なエラーログ
  - クラッシュレポート（Sentry等）
  - ユーザーへの適切なエラーメッセージ表示
  - 音声ファイル読み込みエラーのリカバリー

### 10.3 アクセシビリティ
- **基本対応**:
  - スクリーンリーダー対応（VoiceOver/TalkBack）
  - 適切なアクセシビリティラベル
  - 十分なコントラスト比

### 10.4 パフォーマンス
- **標準的なパフォーマンス**: 特別な最適化要件なし
- **アプリサイズ**: 制約なし（音質優先）

---

## 11. リリース計画

### 11.1 プラットフォーム
- App Store（iOS）
- Google Play（Android）
- 同時リリース

### 11.2 価格
- **完全無料**
- 広告なし
- アプリ内課金なし

### 11.3 必要なアセット
- [ ] アプリアイコン（UIデザインを基に作成）
- [ ] スプラッシュスクリーン
- [ ] ストアスクリーンショット
- [ ] ストア掲載文（日本語・英語）

---

## 12. 将来の拡張候補（スコープ外）

以下は初期リリースには含まれないが、将来的な拡張候補として記録:

- 追加環境音（雨音、波音、焚き火等）
- バックグラウンド再生継続オプション
- カスタム時間設定
- タイマー完了通知
- ダークモード
- ウィジェット対応
- Apple Watch / Wear OS対応

---

## 更新履歴

| 日付 | バージョン | 内容 |
|------|-----------|------|
| 2026-01-01 | 1.0 | 初版作成（インタビューに基づく詳細仕様） |
